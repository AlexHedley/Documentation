---
layout: Meadow
title: PWM
subtitle: Pulse-Width-Modulation Output
---

# Introduction

Pulse-Width-Modulation is a way of controlling voltage digitally to emulate an analog signal. By turning a digital output `ON` and `OFF` very rapidly, an intermediate average output voltage can be achieved:

![](PWM_Signal.svg)

Although PWM is a modulation technique that can be used for communication, it's most often used to:

- Limit the voltage being supplied to a device.
- Vary the output of LEDs.
- Control motors such as servos.

A PWM signal generated by a Meadow is a square wave that can be described by two key parameters known as the _duty cycle_ and _frequency_.

## Duty Cycle

The duty cycle describes the percentage of time the signal is `ON`/`HIGH`, and the average output voltage is directly tied to this parameter. Consider the following wave with a duty cycle of `0.5` (50%):

![PWM 50% Duty Cycle](50p_PWM_Signal.svg)

In the above diagram, the signal is `ON`/`HIGH` half of the time, and `OFF`/`LOW` the other half. The average voltage output is therefore `1.6V`, since `3.3V * 0.5 = 1.6V`.

If the duty cycle were lowered to 25% (`0.25`), then the average voltage output would also be lowered:

![PWM 25% Duty Cycle](25p_PWM_Signal.svg)

In this case, the average voltage output would be around `0.8V`, since `3.3V * 0.25 = 0.825V`

## Frequency

Note that in both cases, the frequency is the same; the rising edges of the signal are aligned to the same point in time. 

So the frequency is the same but the duty cycle is different.

However, for a higher resolution signal, the frequency can be increased while keeping the same duty cycle. Consider the following PWM with a 50% duty cycle but a frequency twice as high as the previous signals:

![PWM 50% Duty Cycle with 2x Frequency](50p_2xF_PWM_Signal.svg)

In this case, the signal is cycling `ON`/`OFF` twice as fast as the 50% cycle before, but still providing the same average voltage output. 

Higher frequencies create smoother signals, and are required in some cases. For instance, when using a PWM signal to control the brightness of an LED, a frequency of at least 60Hz (60 cycles per second) is required because humans will notice a flicker in frequencies below that.

## Signal Generation

PWM signals can be generated via hardware (on the microcontroller) as well as via software. However, except for very slow frequencies, the hardware PWM generator should be used, as it doesn't cause any load on the processor.

### API

[tbd]


# Meadow PWM Pins

--
Note that the onboard LED can also be configured as a PWM channel.

# Practical Examples

As noted, there are three main uses for PWM that are most frequently encountered:

- Power Control
- LED Brightness
- [Servo Control](/Hardware/Reference/Peripherals/Servos)

## Power Control

The output voltage on a Netduino digital output pin is 3.3V.  Creating a digital output pin (_OutputPort_) and turning the pin on will show 3.3V on a multimeter.

Changing the output port to a _PWM_ port and setting the duty cycle to 10% will change the reading on the multimeter.  Consider the following application:

```csharp
using System.Threading;
using Microsoft.SPOT.Hardware;
using SecretLabs.NETMF.Hardware.NetduinoPlus;
using Microsoft.SPOT;

namespace PWMExample
{
	public class Program
	{
		public static void Main()
		{
            Debug.Print("Application starting...");
            PWM led1 = new PWM(PWMChannels.PWM_PIN_D9, 100d, 0.1d, false);
			led1.Start();
            Thread.Sleep(Timeout.Infinite);
		}
	}
}
```

Running this results in the following output on a multimeter and oscilloscope:

![100Hz Signal at 10% Duty Cycle](10PercentDutyCycle.jpg)

The multimeter shows the average reading is 0.332V (10% of the output voltage of a pin on the Netduino).  The oscilloscope is showing the actual waveform and the measurements, 100Hz signal with a 10% duty cycle and an output voltage of 3.32V.

## Changing the Brightness of an LED

One of the most visible uses of PWM is to [control the brightness of an LED](/Hardware/Reference/Components/LEDs/Driving_w_PWM/).  A low duty cycle results in a dim LED, a higher duty cycle produces a brighter LED.

# Controlling a Servo

The next section of this guide demonstrates how to [control the position of a servo using PWM](/Hardware/Reference/Peripherals/Servos).

# Further Reading

* [PWM on Wikipedia](https://en.wikipedia.org/wiki/Pulse-width_modulation)
* [NETMF PWM Reference](https://msdn.microsoft.com/en-us/library/microsoft.spot.hardware.pwm(v=vs.102).aspx)
